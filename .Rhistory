"leslie", "min", "cusi", "birdy", "lynn", "bod",
"manolo", "jessica", "jessi", "winner", "karana",
"valencia", "beetle", "sarah", "sara", "squirrel",
"bear", "jesse", "mary", "mar", "award", "awards",
"awarded", "awarding", "xan", "miyax", "julie",
"write", "word", "words", "writing", "writes",
"catherine")
review_words <- tokenize_words(reviews$Reviews,
stopwords = my_stopwords,
strip_numeric = TRUE) %>%
sapply(., paste, collapse = " ")
substr(review_words[1:3], 1, 500)
newbery_corpus <- review_words %>% VectorSource() %>% Corpus()
newbery_dtm <- newbery_corpus %>%
DocumentTermMatrix(control = list(removeNumbers = TRUE,
stopwords = my_stopwords,
stemming = TRUE,
removePunctuation = TRUE,
tolower = TRUE))
lda_model <- LDA(newbery_dtm, k = 10, control = list(seed = 100))
reviews_topics <- tidy(lda_model, matrix = "beta")
top_terms <- reviews_topics %>%
group_by(topic) %>%
top_n(5, beta) %>%
ungroup() %>%
arrange(topic, -beta)
reviews_topics <- tidy(lda_model, matrix = "beta")
top_terms <- reviews_topics %>%
group_by(topic) %>%
top_n(10, beta) %>%
ungroup() %>%
arrange(topic, -beta)
top_terms %>% filter(topic == 1)
top_terms %>% filter(topic == 2)
top_terms %>% filter(topic == 3)
top_terms %>% filter(topic == 4)
top_terms %>% filter(topic == 5)
top_terms %>% filter(topic == 6)
top_terms %>% filter(topic == 7)
top_terms %>% filter(topic == 8)
top_terms %>% filter(topic == 8)
top_terms %>% filter(topic == 9)
top_terms %>% filter(topic == 10)
my_stopwords <- c(stop_words$word, title_words, author_names,
"read", "reading", "reads", "newbery", "john",
"story", "stories", "book", "books",
"character", "characters", "children", "lucinda",
"reader", "katy", "katie", "kate", "chapter",
"louis", "louisa", "tree", "ear", "josh",
"stanley", "readers", "author", "louise",
"virgil", "kit", "katherine", "slater", "slaters",
"mafatu", "mafatus", "annemarie", "claudia",
"marty", "page", "pages", "miranda", "boyer",
"boyers", "eversleigh", "andy", "abilene",
"andys", "alyce", "alcott", "jonas", "jonah",
"cassie", "leigh", "luna", "aerin", "garnet",
"jeff", "jeffrey", "salamanca", "sal", "sham",
"phoebe", "nathaniel", "nat", "roger", "jess",
"leslie", "min", "cusi", "birdy", "lynn", "bod",
"manolo", "jessica", "jessi", "winner", "karana",
"valencia", "beetle", "sarah", "sara", "squirrel",
"bear", "jesse", "mary", "mar", "award", "awards",
"awarded", "awarding", "xan", "miyax", "julie",
"write", "word", "words", "writing", "writes",
"catherine", "kaori")
review_words <- tokenize_words(reviews$Reviews,
stopwords = my_stopwords,
strip_numeric = TRUE) %>%
sapply(., paste, collapse = " ")
substr(review_words[1:3], 1, 500)
newbery_corpus <- review_words %>% VectorSource() %>% Corpus()
newbery_dtm <- newbery_corpus %>%
DocumentTermMatrix(control = list(removeNumbers = TRUE,
stopwords = my_stopwords,
stemming = TRUE,
removePunctuation = TRUE,
tolower = TRUE))
lda_model <- LDA(newbery_dtm, k = 10, control = list(seed = 100))
reviews_topics <- tidy(lda_model, matrix = "beta")
top_terms <- reviews_topics %>%
group_by(topic) %>%
top_n(10, beta) %>%
ungroup() %>%
arrange(topic, -beta)
top_terms %>% filter(topic == 1)
top_terms %>% filter(topic == 2)
top_terms %>% filter(topic == 3)
top_terms %>% filter(topic == 4)
top_terms %>% filter(topic == 5)
top_terms %>% filter(topic == 6)
top_terms %>% filter(topic == 7)
top_terms %>% filter(topic == 8)
top_terms %>% filter(topic == 9)
top_terms %>% mutate(term = reorder_within(term, beta, topic)) %>%
ggplot(aes(term, beta, fill = factor(topic))) +
geom_col(show.legend = FALSE) +
facet_wrap(~ topic, scales = "free") +
coord_flip() +
scale_x_reordered()
newbery_corpus <- review_words %>% VectorSource() %>% Corpus()
newbery_dtm <- newbery_corpus %>%
DocumentTermMatrix(control = list(removeNumbers = TRUE,
stopwords = my_stopwords,
stemming = TRUE,
removePunctuation = TRUE,
tolower = TRUE))
lda_model <- LDA(newbery_dtm, k = 10, control = list(seed = 100))
reviews_topics <- tidy(lda_model, matrix = "beta")
top_terms <- reviews_topics %>%
group_by(topic) %>%
top_n(10, beta) %>%
ungroup() %>%
arrange(topic, -beta)
topTerms %>% mutate(term = reorder_within(term, beta, topic)) %>%
ggplot(aes(term, beta, fill = factor(topic))) +
geom_col(show.legend = FALSE) +
facet_wrap(~ topic, scales = "free") +
coord_flip() +
scale_x_reordered()
top_terms %>% mutate(term = reorder_within(term, beta, topic)) %>%
ggplot(aes(term, beta, fill = factor(topic))) +
geom_col(show.legend = FALSE) +
facet_wrap(~ topic, scales = "free") +
coord_flip() +
scale_x_reordered()
test <- newbery_dtm %>% as.matrix()
test[1:10,1:10]
test <- TermDocFreq(as.matrix(newbery_dtm))
test
98/3
latin_apstrphe <- iconv("\u0092", from = "UTF-8", to = "latin1")
reviews$Reviews <- gsub(latin_apstrphe, "'", reviews$Reviews)
my_stopwords <- stop_words$word
reviews_file <- "files/book_reviews.xlsx"
reviews <- read.xlsx(reviews_file)
substr(reviews$Reviews[1:3], 1, 500)
latin_apstrphe <- iconv("\u0092", from = "UTF-8", to = "latin1")
reviews$Reviews <- gsub(latin_apstrphe, "'", reviews$Reviews)
my_stopwords <- stop_words$word
review_words <- tokenize_words(reviews$Reviews,
stopwords = my_stopwords,
strip_numeric = TRUE) %>%
sapply(., paste, collapse = " ")
substr(review_words[1:3], 1, 500)
latin_apstrphe <- iconv("\u0092", from = "UTF-8", to = "latin1")
reviews$Reviews <- gsub(latin_apstrphe, "'", reviews$Reviews)
my_stopwords <- stop_words$word
review_words <- tokenize_words(reviews$Reviews,
stopwords = my_stopwords,
strip_numeric = TRUE) %>%
sapply(., paste, collapse = " ")
substr(review_words[1:3], 1, 500)
newbery_corpus <- review_words %>% VectorSource() %>% Corpus()
newbery_dtm <- newbery_corpus %>%
DocumentTermMatrix(control = list(removeNumbers = TRUE,
stopwords = my_stopwords,
stemming = TRUE,
removePunctuation = TRUE,
tolower = TRUE))
termdoc_freqs <- TermDocFreq(as.matrix(newbery_dtm))
head(termdoc_freqs)
98/3
select_words <- termdoc_freqs %>%
filter(term_freq < 20 | doc_freq < 33) %>%
select(term)
dim(select_words)
select_words
termdoc_freqs %>% filter(term == "betsi")
select_words <- termdoc_freqs %>%
filter(term_freq >= 20 & doc_freq >= 33) %>%
select(term)
length(select_words)
select_words$term
length(select_words$term)
newbery_dtm <- newbery_corpus %>%
DocumentTermMatrix(control = list(removeNumbers = TRUE,
stopwords = stop_words$word,
stemming = FALSE,
removePunctuation = TRUE,
tolower = TRUE))
termdoc_freqs <- TermDocFreq(as.matrix(newbery_dtm))
select_words <- termdoc_freqs %>%
filter(term_freq >= 20 & doc_freq >= 33) %>%
select(term)
select_words$term
dtm_matrix <- as.matrix(newbery_dtm)
termdoc_freqs <- TermDocFreq(dtm_matrix)
select_words <- termdoc_freqs %>%
filter(term_freq >= 20 & doc_freq >= 33) %>%
select(term)
select_words <- termdoc_freqs %>%
filter(term_freq >= 20 & doc_freq >= 33) %>%
select(term)
red_dtm <- dtm_matrix[,select_words$term]
dim(red_dtm)
red_dtm
remove_words <- termdoc_freqs %>%
filter(!(term_freq >= 20 & doc_freq >= 33)) %>%
select(term)
remove_words
my_stopwords <- c(stop_words$word, remove_words)
my_stopwords <- c(stop_words$word, remove_words)
newbery_dtm2 <- newbery_corpus %>%
DocumentTermMatrix(control = list(removeNumbers = TRUE,
stopwords = my_stopwords,
stemming = TRUE,
removePunctuation = TRUE,
tolower = TRUE))
dim(as.matrix(newbery_dtm2))
length(remove_words)
length(remove_words$term)
dim(newbery_dtm)
termdoc_freqs %>%
filter(!(term_freq >= 20 & doc_freq >= 33)) %>% dim()
(termdoc_freqs %>%
filter(!(term_freq >= 20 & doc_freq >= 33))) %>% dim()
test <- termdoc_freqs %>%
filter(!(term_freq >= 20 & doc_freq >= 33))
test
my_stopwords
my_stopwords <- c(stop_words$word, remove_words$term)
newbery_dtm2 <- newbery_corpus %>%
DocumentTermMatrix(control = list(removeNumbers = TRUE,
stopwords = my_stopwords,
stemming = TRUE,
removePunctuation = TRUE,
tolower = TRUE))
dim(as.matrix(newbery_dtm2))
newbery_dtm2
newbery_dtm2 %>% as.matrix()
suppressMessages({
suppressWarnings({
library(openxlsx)
library(ldatuning)
library(topicmodels)
library(tokenizers)
library(textmineR)
library(tm)
library(tidyverse)
library(tidytext)
library(xtable)
library(Matrix)
})
})
reviews_file <- "files/book_reviews.xlsx"
reviews <- read.xlsx(reviews_file)
substr(reviews$Reviews[1:3], 1, 500)
avenger_words <- cbind(c("america", "justice", "freedom"),
c("punch", "kick", "justice"),
c("tech", "gadgets", "justice"),
c("thanos", "government", "justice"))
colnames(avenger_words) <- c("Topic 1", "Topic 2",
"Topic 3", "Topic 4")
rownames(avenger_words) <- c("Word 1", "Word 2", "Word 3")
xtable(avenger_words)
latin_apstrphe <- iconv("\u0092", from = "UTF-8", to = "latin1")
reviews$Reviews <- gsub(latin_apstrphe, "'", reviews$Reviews)
review_words <- tokenize_words(reviews$Reviews,
stopwords = stop_words$word,
strip_numeric = TRUE) %>%
sapply(., paste, collapse = " ")
substr(review_words[1:3], 1, 500)
latin_apstrphe <- iconv("\u0092", from = "UTF-8", to = "latin1")
reviews$Reviews <- gsub(latin_apstrphe, "'", reviews$Reviews)
newbery_corpus <- reviews$Reviews %>% VectorSource() %>% Corpus()
newbery_dtm <- newbery_corpus %>%
DocumentTermMatrix(control = list(removeNumbers = TRUE,
stopwords = stop_words$word,
stemming = FALSE,
removePunctuation = TRUE,
tolower = TRUE))
dtm_matrix <- as.matrix(newbery_dtm)
termdoc_freqs <- TermDocFreq(dtm_matrix)
remove_words <- termdoc_freqs %>%
filter(!(term_freq >= 20 & doc_freq >= 33)) %>%
select(term)
my_stopwords <- c(stop_words$word, remove_words$term)
my_stopwords <- c(stop_words$word, remove_words$term)
my_stopwords
review_words <- tokenize_words(reviews$Reviews,
stopwords = my_stopwords,
strip_numeric = TRUE) %>%
sapply(., paste, collapse = " ")
substr(review_words[1:3], 1, 500)
str_detect(remove_words, "phillip")
str_detect(remove_words$term, "phillip")
str_detect(remove_words$term, "phillip") %>% sum()
str_detect(remove_words$term, "phillip's") %>% sum()
remove_words <- termdoc_freqs %>%
filter(term_freq < 20 | doc_freq < 33) %>%
select(term)
remove_words$term
which(remove_words$term == "phillip")
which(remove_words$term == "phillip's")
which(remove_words$term == "phillip's")
which(remove_words$term == "phillips")
latin_apstrphe <- iconv("\u0092", from = "UTF-8", to = "latin1")
reviews$Reviews <- gsub(latin_apstrphe, "'", reviews$Reviews)
newbery_corpus <- reviews$Reviews %>% VectorSource() %>% Corpus()
newbery_dtm <- newbery_corpus %>%
DocumentTermMatrix(control = list(removeNumbers = TRUE,
stopwords = stop_words$word,
stemming = FALSE,
removePunctuation = TRUE,
tolower = TRUE))
dtm_matrix <- as.matrix(newbery_dtm)
termdoc_freqs <- TermDocFreq(dtm_matrix)
remove_words <- termdoc_freqs %>%
filter(term_freq < 20 | doc_freq < 33) %>%
select(term)
my_stopwords <- c(stop_words$word, remove_words$term)
review_words <- tokenize_words(reviews$Reviews,
stopwords = my_stopwords,
strip_numeric = TRUE) %>%
sapply(., paste, collapse = " ")
substr(review_words[1:3], 1, 500)
substr(review_words[1:3], 1, 500)
newbery_dtm2 <- newbery_corpus %>%
DocumentTermMatrix(control = list(removeNumbers = TRUE,
stopwords = my_stopwords,
stemming = TRUE,
removePunctuation = TRUE,
tolower = TRUE))
dim(as.matrix(newbery_dtm2))
newbery_dtm2 <- newbery_corpus %>%
DocumentTermMatrix(control = list(removeNumbers = TRUE,
stopwords = my_stopwords,
stemming = TRUE,
removePunctuation = TRUE,
tolower = TRUE))
lda_model <- LDA(newbery_dtm2, k = 10, control = list(seed = 100))
reviews_topics <- tidy(lda_model, matrix = "beta")
top_terms <- reviews_topics %>%
group_by(topic) %>%
top_n(10, beta) %>%
ungroup() %>%
arrange(topic, -beta)
top_terms %>% mutate(term = reorder_within(term, beta, topic)) %>%
ggplot(aes(term, beta, fill = factor(topic))) +
geom_col(show.legend = FALSE) +
facet_wrap(~ topic, scales = "free") +
coord_flip() +
scale_x_reordered()
latin_apstrphe <- iconv("\u0092", from = "UTF-8", to = "latin1")
reviews$Reviews <- gsub(latin_apstrphe, "'", reviews$Reviews)
newbery_corpus <- reviews$Reviews %>% VectorSource() %>% Corpus()
newbery_dtm <- newbery_corpus %>%
DocumentTermMatrix(control = list(removeNumbers = TRUE,
stopwords = stop_words$word,
stemming = FALSE,
removePunctuation = TRUE,
tolower = TRUE))
dtm_matrix <- as.matrix(newbery_dtm)
termdoc_freqs <- TermDocFreq(dtm_matrix)
remove_words <- termdoc_freqs %>%
filter(term_freq < 20 | doc_freq < 10) %>%
select(term)
my_stopwords <- c(stop_words$word, remove_words$term, "book",
"chapter", "newbery", "story", "stories",
"books", "read", "reader", "read", "reading",
"character", "characters", "john", "award")
review_words <- tokenize_words(reviews$Reviews,
stopwords = my_stopwords,
strip_numeric = TRUE) %>%
sapply(., paste, collapse = " ")
substr(review_words[1:3], 1, 500)
newbery_dtm2 <- newbery_corpus %>%
DocumentTermMatrix(control = list(removeNumbers = TRUE,
stopwords = my_stopwords,
stemming = TRUE,
removePunctuation = TRUE,
tolower = TRUE))
lda_model <- LDA(newbery_dtm2, k = 10, control = list(seed = 100))
reviews_topics <- tidy(lda_model, matrix = "beta")
top_terms <- reviews_topics %>%
group_by(topic) %>%
top_n(10, beta) %>%
ungroup() %>%
arrange(topic, -beta)
top_terms %>% mutate(term = reorder_within(term, beta, topic)) %>%
ggplot(aes(term, beta, fill = factor(topic))) +
geom_col(show.legend = FALSE) +
facet_wrap(~ topic, scales = "free") +
coord_flip() +
scale_x_reordered()
15/98
remove_words <- termdoc_freqs %>%
filter(term_freq < 20 | doc_freq < 15) %>%
select(term)
my_stopwords <- c(stop_words$word, remove_words$term, "book",
"chapter", "newbery", "story", "stories",
"books", "read", "reader", "read", "reading",
"character", "characters", "john", "award")
review_words <- tokenize_words(reviews$Reviews,
stopwords = my_stopwords,
strip_numeric = TRUE) %>%
sapply(., paste, collapse = " ")
substr(review_words[1:3], 1, 500)
newbery_dtm2 <- newbery_corpus %>%
DocumentTermMatrix(control = list(removeNumbers = TRUE,
stopwords = my_stopwords,
stemming = TRUE,
removePunctuation = TRUE,
tolower = TRUE))
lda_model <- LDA(newbery_dtm2, k = 10, control = list(seed = 100))
reviews_topics <- tidy(lda_model, matrix = "beta")
top_terms <- reviews_topics %>%
group_by(topic) %>%
top_n(10, beta) %>%
ungroup() %>%
arrange(topic, -beta)
top_terms %>% mutate(term = reorder_within(term, beta, topic)) %>%
ggplot(aes(term, beta, fill = factor(topic))) +
geom_col(show.legend = FALSE) +
facet_wrap(~ topic, scales = "free") +
coord_flip() +
scale_x_reordered()
newbery_dtm2 <- newbery_corpus %>%
DocumentTermMatrix(control = list(removeNumbers = TRUE,
stopwords = my_stopwords,
stemming = TRUE,
removePunctuation = TRUE,
tolower = TRUE))
lda_model <- LDA(newbery_dtm2, k = 6, control = list(seed = 100))
reviews_topics <- tidy(lda_model, matrix = "beta")
reviews_topics <- tidy(lda_model, matrix = "beta")
top_terms <- reviews_topics %>%
group_by(topic) %>%
top_n(10, beta) %>%
ungroup() %>%
arrange(topic, -beta)
top_terms %>% mutate(term = reorder_within(term, beta, topic)) %>%
ggplot(aes(term, beta, fill = factor(topic))) +
geom_col(show.legend = FALSE) +
facet_wrap(~ topic, scales = "free") +
coord_flip() +
scale_x_reordered()
top_terms <- reviews_topics %>%
group_by(topic) %>%
top_n(15, beta) %>%
ungroup() %>%
arrange(topic, -beta)
top_terms %>% mutate(term = reorder_within(term, beta, topic)) %>%
ggplot(aes(term, beta, fill = factor(topic))) +
geom_col(show.legend = FALSE) +
facet_wrap(~ topic, scales = "free") +
coord_flip() +
scale_x_reordered()
top_terms <- reviews_topics %>%
group_by(topic) %>%
top_n(20, beta) %>%
ungroup() %>%
arrange(topic, -beta)
top_terms %>% mutate(term = reorder_within(term, beta, topic)) %>%
ggplot(aes(term, beta, fill = factor(topic))) +
geom_col(show.legend = FALSE) +
facet_wrap(~ topic, scales = "free") +
coord_flip() +
scale_x_reordered()
top_terms <- reviews_topics %>%
group_by(topic) %>%
top_n(15, beta) %>%
ungroup() %>%
arrange(topic, -beta)
top_terms %>% mutate(term = reorder_within(term, beta, topic)) %>%
ggplot(aes(term, beta, fill = factor(topic))) +
geom_col(show.legend = FALSE) +
facet_wrap(~ topic, scales = "free") +
coord_flip() +
scale_x_reordered()
reviews_topics$beta
reviews_topics$topic
lda_model@documents
lda_model@gamma
max_doc_topics <- apply(lda_model@gamma, 1, which.max)
max_doc_topics
data.frame(topic_number = max_doc_topics,
book_name = reviews$Book) %>%
ggplot(aes(y = topic_number)) +
geom_bar() + facet_wrap(~book_name)
reviews$Book[max_doc_topics == 1]
reviews$Book[max_doc_topics == 2]
reviews$Book[max_doc_topics == 1]
reviews$Book[max_doc_topics == 1]
lda_model@gamma[max_doc_topics == 1,]
reviews$Book[max_doc_topics == 1]
reviews$Book[max_doc_topics == 2]
reviews$Book[max_doc_topics == 3]
reviews$Book[max_doc_topics == 3]
reviews$Book[max_doc_topics == 4]
reviews$Book[max_doc_topics == 5]
reviews$Book[max_doc_topics == 6]
reviews$Book[max_doc_topics == 3]
reviews$Book[max_doc_topics == 4]
reviews$Book[max_doc_topics == 5]
reviews$Book[max_doc_topics == 6]
lda_model@gamma[1,]
reviews$Book
lda_model@gamma[78,]
lda_model@gamma[55,]
avenger_words <- cbind(c("america", "justice", "freedom"),
c("punch", "kick", "justice"),
c("tech", "gadgets", "justice"),
c("thanos", "government", "justice"))
colnames(avenger_words) <- c("Topic 1", "Topic 2",
"Topic 3", "Topic 4")
rownames(avenger_words) <- c("Word 1", "Word 2", "Word 3")
xtable(avenger_words)
xtable(avenger_words)
avenger_xtable <- xtable(avenger_words)
print(avenger_xtable, type = "html")
print(avenger_xtable, type = "html")
